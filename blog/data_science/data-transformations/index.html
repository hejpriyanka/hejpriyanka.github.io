<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Data Transformation Strategies for Clean and Consistent Data | Priyanka Yelluru</title>
<meta name=keywords content="ETL,Data Engineering,Data Cleaning,Normalization,SQL"><meta name=description content="Learn essential data transformation techniques for cleaning, normalizing, and harmonizing data in ETL pipelines."><meta name=author content="Priyanka Yelluru"><link rel=canonical href=https://priya.se/blog/data_science/data-transformations/><link crossorigin=anonymous href=/assets/css/stylesheet.51e815373e8719f87994fad2043c4a754a45c215e74d4c37660ea05e87cce8ca.css integrity="sha256-UegVNz6HGfh5lPrSBDxKdUpFwhXnTUw3Zg6gXofM6Mo=" rel="preload stylesheet" as=style><link rel=icon href=https://priya.se/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://priya.se/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://priya.se/favicon-32x32.png><link rel=apple-touch-icon href=https://priya.se/apple-touch-icon.png><link rel=mask-icon href=https://priya.se/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://priya.se/blog/data_science/data-transformations/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://priya.se/blog/data_science/data-transformations/"><meta property="og:site_name" content="Priyanka Yelluru"><meta property="og:title" content="Data Transformation Strategies for Clean and Consistent Data"><meta property="og:description" content="Learn essential data transformation techniques for cleaning, normalizing, and harmonizing data in ETL pipelines."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2025-03-01T00:00:00+00:00"><meta property="article:modified_time" content="2025-03-01T00:00:00+00:00"><meta property="article:tag" content="ETL"><meta property="article:tag" content="Data Engineering"><meta property="article:tag" content="Data Cleaning"><meta property="article:tag" content="Normalization"><meta property="article:tag" content="SQL"><meta name=twitter:card content="summary"><meta name=twitter:title content="Data Transformation Strategies for Clean and Consistent Data"><meta name=twitter:description content="Learn essential data transformation techniques for cleaning, normalizing, and harmonizing data in ETL pipelines."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://priya.se/blog/"},{"@type":"ListItem","position":2,"name":"Data Transformation Strategies for Clean and Consistent Data","item":"https://priya.se/blog/data_science/data-transformations/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Data Transformation Strategies for Clean and Consistent Data","name":"Data Transformation Strategies for Clean and Consistent Data","description":"Learn essential data transformation techniques for cleaning, normalizing, and harmonizing data in ETL pipelines.","keywords":["ETL","Data Engineering","Data Cleaning","Normalization","SQL"],"articleBody":"Introduction In data processing, raw data from source systems is often inconsistent, messy, or lacks standardization. Data transformation techniques help to clean, normalize, and harmonize this data before it is used for analysis or loaded into structured schemas like a data warehouse. This blog explores multiple techniques used in SQL-based data transformation to convert raw data into clean, meaningful information.\n1. Removing Unnecessary Whitespaces Purpose: Trim leading and trailing whitespace to maintain consistency in textual fields.\nExample: Data Before: customer_id first_name last_name 101 \" John \" \" Doe \" 102 \" Alice \" \" Brown \" SQL Transformation: SELECT customer_id, TRIM(first_name) AS first_name, TRIM(last_name) AS last_name FROM customers; Data After: customer_id first_name last_name 101 “John” “Doe” 102 “Alice” “Brown” 2. Handling Missing or Invalid Data Purpose: Replace null or incorrect values with default values or meaningful alternatives.\nExample: Data Before: customer_id email 101 “john@abc.com” 102 NULL SQL Transformation: SELECT customer_id, COALESCE(email, 'unknown@xyz.com') AS email FROM customers; Data After: customer_id email 101 “john@abc.com” 102 “unknown@xyz.com” 3. Deduplication Purpose: Identify and remove duplicate records while retaining the most recent or relevant entry.\nExample: Data Before: customer_id first_name last_name created_at 101 John Doe 2024-01-10 10:00 101 John Doe 2024-01-12 12:30 SQL Transformation: WITH RankedCustomers AS ( SELECT *, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY created_at DESC) AS rn FROM customers ) SELECT customer_id, first_name, last_name, created_at FROM RankedCustomers WHERE rn = 1; Data After: customer_id first_name last_name created_at 101 John Doe 2024-01-12 12:30 4. Normalization and Harmonization Purpose: Standardize categorical values to ensure consistency and accuracy.\nExample: Data Before: marital_status gender product_line country “S” “F” “M” “DE” “M” “M” “R” “US” “Unknown” “U” “X” “USA” NULL \"\" “T” \"\" SQL Transformation: SELECT CASE marital_status WHEN 'S' THEN 'Single' WHEN 'M' THEN 'Married' ELSE 'n/a' END AS marital_status, CASE gender WHEN 'F' THEN 'Female' WHEN 'M' THEN 'Male' ELSE 'n/a' END AS gender, CASE product_line WHEN 'M' THEN 'Mountain' WHEN 'R' THEN 'Road' WHEN 'S' THEN 'Other Sales' WHEN 'T' THEN 'Touring' ELSE 'n/a' END AS product_line, CASE country WHEN 'DE' THEN 'Germany' WHEN 'US' THEN 'United States' WHEN 'USA' THEN 'United States' ELSE 'n/a' END AS country FROM products; Data After: marital_status gender product_line country “Single” “Female” “Mountain” “Germany” “Married” “Male” “Road” “United States” “n/a” “n/a” “n/a” “United States” “n/a” “n/a” “Touring” “n/a” 5. Deriving Values Purpose: Compute missing or dependent values based on existing fields.\nExample: Data Before: order_id quantity unit_price total_price 5001 3 NULL 60.00 5002 2 20.00 NULL 5003 4 NULL NULL 5004 1 15.00 15.00 SQL Transformation: SELECT order_id, quantity, COALESCE(unit_price, total_price / quantity) AS unit_price, COALESCE(total_price, quantity * unit_price) AS total_price FROM orders; Data After: order_id quantity unit_price total_price 5001 3 20.00 60.00 5002 2 20.00 40.00 5003 4 NULL NULL 5004 1 15.00 15.00 6. Conditional Mapping Using CASE WHEN 6a. Standardizing Categorical Data Purpose: Convert inconsistent category formats to a standard format.\nData Before: product_code category_code “P100” “A-200” “P101” “B-300” “P102” “C400” SQL Transformation: SELECT product_code, REPLACE(category_code, '-', '_') AS category_code FROM products; Data After: product_code category_code “P100” “A_200” “P101” “B_300” “P102” “C400” 6b. Handling Date Transformations Purpose: Format dates from a compact string to a standard date format.\nData Before: order_date “20240101” “20231231” “20230715” SQL Transformation: SELECT order_date, TO_DATE(order_date, 'YYYYMMDD') AS formatted_order_date FROM orders; Data After: order_date formatted_order_date “20240101” “2024-01-01” “20231231” “2023-12-31” “20230715” “2023-07-15” 6c. Calculating Order Status Purpose: Derive the shipment status based on shipment and delivery dates.\nData Before: shipped_date delivered_date NULL “2024-02-10” “2024-02-05” “2024-02-07” “2024-02-08” NULL “2024-02-09” NULL NULL NULL SQL Transformation: SELECT shipped_date, delivered_date, CASE WHEN shipped_date IS NULL THEN 'Pending Shipment' WHEN delivered_date IS NOT NULL THEN 'Delivered' ELSE 'In Transit' END AS status FROM shipments; Data After: shipped_date delivered_date status NULL “2024-02-10” “Pending Shipment” “2024-02-05” “2024-02-07” “Delivered” “2024-02-08” NULL “In Transit” “2024-02-09” NULL “In Transit” NULL NULL “Pending Shipment” 7. Extracting Year and Month from Dates Purpose: Isolate year and month components from a date for time-series analysis.\nData Before: order_date “2024-05-15” “2023-11-30” “2024-01-01” “2024-12-25” SQL Transformation: SELECT order_date, EXTRACT(YEAR FROM order_date) AS order_year, EXTRACT(MONTH FROM order_date) AS order_month FROM orders; Data After: order_date order_year order_month “2024-05-15” 2024 5 “2023-11-30” 2023 11 “2024-01-01” 2024 1 “2024-12-25” 2024 12 8. Aggregating Data Purpose: Summarize data by grouping and applying aggregate functions like SUM, AVG, COUNT, etc.\nData Before: product_id quantity 101 5 102 3 101 2 103 4 SQL Transformation: SELECT product_id, SUM(quantity) AS total_quantity FROM orders GROUP BY product_id; Data After: product_id total_quantity 101 7 102 3 103 4 9. Pivoting Data Purpose: Transform rows into columns to create a pivot table.\nData Before: product_id month sales 101 Jan 100 101 Feb 150 102 Jan 200 102 Feb 250 SQL Transformation: SELECT product_id, SUM(CASE WHEN month = 'Jan' THEN sales ELSE 0 END) AS Jan_sales, SUM(CASE WHEN month = 'Feb' THEN sales ELSE 0 END) AS Feb_sales FROM sales GROUP BY product_id; Data After: product_id Jan_sales Feb_sales 101 100 150 102 200 250 10. Unpivoting Data Purpose: Transform columns into rows to normalize a pivot table.\nData Before: product_id Jan_sales Feb_sales 101 100 150 102 200 250 SQL Transformation: SELECT product_id, 'Jan' AS month, Jan_sales AS sales FROM sales UNION ALL SELECT product_id, 'Feb' AS month, Feb_sales AS sales FROM sales; Data After: product_id month sales 101 Jan 100 101 Feb 150 102 Jan 200 102 Feb 250 11. Joining Tables Purpose: Combine data from multiple tables based on a related column.\nData Before: Orders Table:\norder_id customer_id 1 101 2 102 Customers Table:\ncustomer_id customer_name 101 John Doe 102 Alice Brown SQL Transformation: SELECT orders.order_id, customers.customer_name FROM orders JOIN customers ON orders.customer_id = customers.customer_id; Data After: order_id customer_name 1 John Doe 2 Alice Brown 12. Filtering Data Purpose: Extract specific rows based on a condition.\nData Before: order_id order_date total_amount 1 2024-01-15 100.00 2 2024-02-20 200.00 3 2024-03-10 150.00 SQL Transformation: SELECT order_id, order_date, total_amount FROM orders WHERE total_amount \u003e 150.00; Data After: order_id order_date total_amount 2 2024-02-20 200.00 13. Calculating Running Totals Purpose: Compute cumulative totals over a specified order.\nData Before: order_id order_date total_amount 1 2024-01-15 100.00 2 2024-02-20 200.00 3 2024-03-10 150.00 SQL Transformation: SELECT order_id, order_date, total_amount, SUM(total_amount) OVER (ORDER BY order_date) AS running_total FROM orders; Data After: order_id order_date total_amount running_total 1 2024-01-15 100.00 100.00 2 2024-02-20 200.00 300.00 3 2024-03-10 150.00 450.00 14. Calculating Moving Averages Purpose: Compute the average of a specified number of preceding rows.\nData Before: order_id order_date total_amount 1 2024-01-15 100.00 2 2024-02-20 200.00 3 2024-03-10 150.00 4 2024-04-05 300.00 SQL Transformation: SELECT order_id, order_date, total_amount, AVG(total_amount) OVER (ORDER BY order_date ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS moving_avg FROM orders; Data After: order_id order_date total_amount moving_avg 1 2024-01-15 100.00 100.00 2 2024-02-20 200.00 150.00 3 2024-03-10 150.00 175.00 4 2024-04-05 300.00 225.00 15. Data Type Conversion Purpose: Convert data from one type to another for consistency and compatibility.\nData Before: order_id order_date total_amount 1 “2024-01-15” “100.00” 2 “2024-02-20” “200.00” SQL Transformation: SELECT order_id, TO_DATE(order_date, 'YYYY-MM-DD') AS order_date, CAST(total_amount AS DECIMAL(10, 2)) AS total_amount FROM orders; Data After: order_id order_date total_amount 1 2024-01-15 100.00 2 2024-02-20 200.00 16. Removing Duplicates Purpose: Eliminate duplicate rows from a dataset to ensure data integrity.\nData Before: customer_id email 101 “john@abc.com” 102 “alice@xyz.com” 101 “john@abc.com” SQL Transformation: SELECT DISTINCT customer_id, email FROM customers; Data After: customer_id email 101 “john@abc.com” 102 “alice@xyz.com” 17. Calculating Percentages Purpose: Compute the percentage of a value relative to a total.\nData Before: product_id sales 101 100 102 200 103 300 SQL Transformation: SELECT product_id, sales, (sales / SUM(sales) OVER ()) * 100 AS sales_percentage FROM products; Data After: product_id sales sales_percentage 101 100 16.67 102 200 33.33 103 300 50.00 18. String Concatenation Purpose: Combine multiple string fields into a single field.\nData Before: first_name last_name John Doe Alice Brown SQL Transformation: SELECT first_name, last_name, CONCAT(first_name, ' ', last_name) AS full_name FROM customers; Data After: first_name last_name full_name John Doe John Doe Alice Brown Alice Brown 19. Conditional Aggregation Purpose: Aggregate data based on a condition.\nData Before: product_id sales region 101 100 North 102 200 South 101 150 North 102 250 South SQL Transformation: SELECT product_id, SUM(CASE WHEN region = 'North' THEN sales ELSE 0 END) AS north_sales, SUM(CASE WHEN region = 'South' THEN sales ELSE 0 END) AS south_sales FROM sales GROUP BY product_id; Data After: product_id north_sales south_sales 101 250 0 102 0 450 20. Data Masking Purpose: Protect sensitive data by masking it.\nData Before: customer_id email 101 “john@abc.com” 102 “alice@xyz.com” SQL Transformation: SELECT customer_id, CONCAT(SUBSTRING(email, 1, 2), '*****', SUBSTRING(email, CHARINDEX('@', email), LEN(email))) AS masked_email FROM customers; Data After: customer_id masked_email 101 “jo*****@abc.com” 102 “al*****@xyz.com” 21. Calculating Differences Purpose: Compute the difference between values in consecutive rows.\nData Before: order_id order_date total_amount 1 2024-01-15 100.00 2 2024-02-20 200.00 3 2024-03-10 150.00 SQL Transformation: SELECT order_id, order_date, total_amount, total_amount - LAG(total_amount) OVER (ORDER BY order_date) AS amount_difference FROM orders; Data After: order_id order_date total_amount amount_difference 1 2024-01-15 100.00 NULL 2 2024-02-20 200.00 100.00 3 2024-03-10 150.00 -50.00 22. Data Binning Purpose: Group continuous data into bins or intervals.\nData Before: order_id total_amount 1 100.00 2 200.00 3 150.00 4 300.00 SQL Transformation: SELECT order_id, total_amount, CASE WHEN total_amount \u003c 150 THEN 'Low' WHEN total_amount BETWEEN 150 AND 250 THEN 'Medium' ELSE 'High' END AS amount_bin FROM orders; Data After: order_id total_amount amount_bin 1 100.00 Low 2 200.00 Medium 3 150.00 Medium 4 300.00 High 23. Handling Outliers Purpose: Identify and handle outliers in the data.\nData Before: order_id total_amount 1 100.00 2 200.00 3 150.00 4 1000.00 SQL Transformation: SELECT order_id, total_amount, CASE WHEN total_amount \u003e 3 * (SELECT AVG(total_amount) FROM orders) THEN 'Outlier' ELSE 'Normal' END AS amount_status FROM orders; Data After: order_id total_amount amount_status 1 100.00 Normal 2 200.00 Normal 3 150.00 Normal 4 1000.00 Outlier Conclusion By applying these transformation techniques, ETL pipelines can ensure that raw data is clean, consistent, and ready for analytics. Whether dealing with text normalization, handling missing values, deduplication, or deriving computed fields, these methods help maintain high-quality datasets essential for business insights.\n","wordCount":"1659","inLanguage":"en","datePublished":"2025-03-01T00:00:00Z","dateModified":"2025-03-01T00:00:00Z","author":{"@type":"Person","name":"Priyanka Yelluru"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://priya.se/blog/data_science/data-transformations/"},"publisher":{"@type":"Organization","name":"Priyanka Yelluru","logo":{"@type":"ImageObject","url":"https://priya.se/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://priya.se/ accesskey=h title="Priyanka Yelluru (Alt + H)">Priyanka Yelluru</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://priya.se/ title=Home><span>Home</span></a></li><li><a href=https://priya.se/about title=About><span>About</span></a></li><li><a href=https://priya.se/blog title=Blog><span>Blog</span></a></li><li><a href=https://priya.se/now title=Now><span>Now</span></a></li><li><a href=https://priya.se/portfolio title=Portfolio><span>Portfolio</span></a></li><li><a href=https://priya.se/contact title=Contact><span>Contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Data Transformation Strategies for Clean and Consistent Data</h1><div class=post-meta><span title='2025-03-01 00:00:00 +0000 UTC'>March 1, 2025</span>&nbsp;·&nbsp;Priyanka Yelluru</div></header><div class=post-content><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>In data processing, raw data from source systems is often inconsistent, messy, or lacks standardization. Data transformation techniques help to clean, normalize, and harmonize this data before it is used for analysis or loaded into structured schemas like a data warehouse. This blog explores multiple techniques used in SQL-based data transformation to convert raw data into clean, meaningful information.</p><h2 id=1-removing-unnecessary-whitespaces>1. Removing Unnecessary Whitespaces<a hidden class=anchor aria-hidden=true href=#1-removing-unnecessary-whitespaces>#</a></h2><p><strong>Purpose:</strong> Trim leading and trailing whitespace to maintain consistency in textual fields.</p><h3 id=example>Example:<a hidden class=anchor aria-hidden=true href=#example>#</a></h3><h4 id=data-before>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before>#</a></h4><table><thead><tr><th>customer_id</th><th>first_name</th><th>last_name</th></tr></thead><tbody><tr><td>101</td><td>" John "</td><td>" Doe "</td></tr><tr><td>102</td><td>" Alice "</td><td>" Brown "</td></tr></tbody></table><h4 id=sql-transformation>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> customer_id, 
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>TRIM</span>(first_name) <span style=color:#66d9ef>AS</span> first_name, 
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>TRIM</span>(last_name) <span style=color:#66d9ef>AS</span> last_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> customers;
</span></span></code></pre></div><h4 id=data-after>Data After:<a hidden class=anchor aria-hidden=true href=#data-after>#</a></h4><table><thead><tr><th>customer_id</th><th>first_name</th><th>last_name</th></tr></thead><tbody><tr><td>101</td><td>&ldquo;John&rdquo;</td><td>&ldquo;Doe&rdquo;</td></tr><tr><td>102</td><td>&ldquo;Alice&rdquo;</td><td>&ldquo;Brown&rdquo;</td></tr></tbody></table><h2 id=2-handling-missing-or-invalid-data>2. Handling Missing or Invalid Data<a hidden class=anchor aria-hidden=true href=#2-handling-missing-or-invalid-data>#</a></h2><p><strong>Purpose:</strong> Replace null or incorrect values with default values or meaningful alternatives.</p><h3 id=example-1>Example:<a hidden class=anchor aria-hidden=true href=#example-1>#</a></h3><h4 id=data-before-1>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-1>#</a></h4><table><thead><tr><th>customer_id</th><th>email</th></tr></thead><tbody><tr><td>101</td><td>&ldquo;<a href=mailto:john@abc.com>john@abc.com</a>&rdquo;</td></tr><tr><td>102</td><td>NULL</td></tr></tbody></table><h4 id=sql-transformation-1>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-1>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> customer_id, 
</span></span><span style=display:flex><span>       COALESCE(email, <span style=color:#e6db74>&#39;unknown@xyz.com&#39;</span>) <span style=color:#66d9ef>AS</span> email
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> customers;
</span></span></code></pre></div><h4 id=data-after-1>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-1>#</a></h4><table><thead><tr><th>customer_id</th><th>email</th></tr></thead><tbody><tr><td>101</td><td>&ldquo;<a href=mailto:john@abc.com>john@abc.com</a>&rdquo;</td></tr><tr><td>102</td><td>&ldquo;<a href=mailto:unknown@xyz.com>unknown@xyz.com</a>&rdquo;</td></tr></tbody></table><h2 id=3-deduplication>3. Deduplication<a hidden class=anchor aria-hidden=true href=#3-deduplication>#</a></h2><p><strong>Purpose:</strong> Identify and remove duplicate records while retaining the most recent or relevant entry.</p><h3 id=example-2>Example:<a hidden class=anchor aria-hidden=true href=#example-2>#</a></h3><h4 id=data-before-2>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-2>#</a></h4><table><thead><tr><th>customer_id</th><th>first_name</th><th>last_name</th><th>created_at</th></tr></thead><tbody><tr><td>101</td><td>John</td><td>Doe</td><td>2024-01-10 10:00</td></tr><tr><td>101</td><td>John</td><td>Doe</td><td>2024-01-12 12:30</td></tr></tbody></table><h4 id=sql-transformation-2>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-2>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>WITH</span> RankedCustomers <span style=color:#66d9ef>AS</span> (
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span>, 
</span></span><span style=display:flex><span>           ROW_NUMBER() OVER (PARTITION <span style=color:#66d9ef>BY</span> customer_id <span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> created_at <span style=color:#66d9ef>DESC</span>) <span style=color:#66d9ef>AS</span> rn
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>FROM</span> customers
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> customer_id, first_name, last_name, created_at
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> RankedCustomers
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> rn <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span></code></pre></div><h4 id=data-after-2>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-2>#</a></h4><table><thead><tr><th>customer_id</th><th>first_name</th><th>last_name</th><th>created_at</th></tr></thead><tbody><tr><td>101</td><td>John</td><td>Doe</td><td>2024-01-12 12:30</td></tr></tbody></table><h2 id=4-normalization-and-harmonization>4. Normalization and Harmonization<a hidden class=anchor aria-hidden=true href=#4-normalization-and-harmonization>#</a></h2><p><strong>Purpose:</strong> Standardize categorical values to ensure consistency and accuracy.</p><h3 id=example-3>Example:<a hidden class=anchor aria-hidden=true href=#example-3>#</a></h3><h4 id=data-before-3>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-3>#</a></h4><table><thead><tr><th>marital_status</th><th>gender</th><th>product_line</th><th>country</th></tr></thead><tbody><tr><td>&ldquo;S&rdquo;</td><td>&ldquo;F&rdquo;</td><td>&ldquo;M&rdquo;</td><td>&ldquo;DE&rdquo;</td></tr><tr><td>&ldquo;M&rdquo;</td><td>&ldquo;M&rdquo;</td><td>&ldquo;R&rdquo;</td><td>&ldquo;US&rdquo;</td></tr><tr><td>&ldquo;Unknown&rdquo;</td><td>&ldquo;U&rdquo;</td><td>&ldquo;X&rdquo;</td><td>&ldquo;USA&rdquo;</td></tr><tr><td>NULL</td><td>""</td><td>&ldquo;T&rdquo;</td><td>""</td></tr></tbody></table><h4 id=sql-transformation-3>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-3>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>CASE</span> marital_status 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>WHEN</span> <span style=color:#e6db74>&#39;S&#39;</span> <span style=color:#66d9ef>THEN</span> <span style=color:#e6db74>&#39;Single&#39;</span> 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>WHEN</span> <span style=color:#e6db74>&#39;M&#39;</span> <span style=color:#66d9ef>THEN</span> <span style=color:#e6db74>&#39;Married&#39;</span> 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>ELSE</span> <span style=color:#e6db74>&#39;n/a&#39;</span> <span style=color:#66d9ef>END</span> <span style=color:#66d9ef>AS</span> marital_status,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>CASE</span> gender 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>WHEN</span> <span style=color:#e6db74>&#39;F&#39;</span> <span style=color:#66d9ef>THEN</span> <span style=color:#e6db74>&#39;Female&#39;</span> 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>WHEN</span> <span style=color:#e6db74>&#39;M&#39;</span> <span style=color:#66d9ef>THEN</span> <span style=color:#e6db74>&#39;Male&#39;</span> 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>ELSE</span> <span style=color:#e6db74>&#39;n/a&#39;</span> <span style=color:#66d9ef>END</span> <span style=color:#66d9ef>AS</span> gender,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>CASE</span> product_line 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>WHEN</span> <span style=color:#e6db74>&#39;M&#39;</span> <span style=color:#66d9ef>THEN</span> <span style=color:#e6db74>&#39;Mountain&#39;</span> 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>WHEN</span> <span style=color:#e6db74>&#39;R&#39;</span> <span style=color:#66d9ef>THEN</span> <span style=color:#e6db74>&#39;Road&#39;</span> 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>WHEN</span> <span style=color:#e6db74>&#39;S&#39;</span> <span style=color:#66d9ef>THEN</span> <span style=color:#e6db74>&#39;Other Sales&#39;</span> 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>WHEN</span> <span style=color:#e6db74>&#39;T&#39;</span> <span style=color:#66d9ef>THEN</span> <span style=color:#e6db74>&#39;Touring&#39;</span> 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>ELSE</span> <span style=color:#e6db74>&#39;n/a&#39;</span> <span style=color:#66d9ef>END</span> <span style=color:#66d9ef>AS</span> product_line,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>CASE</span> country 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>WHEN</span> <span style=color:#e6db74>&#39;DE&#39;</span> <span style=color:#66d9ef>THEN</span> <span style=color:#e6db74>&#39;Germany&#39;</span> 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>WHEN</span> <span style=color:#e6db74>&#39;US&#39;</span> <span style=color:#66d9ef>THEN</span> <span style=color:#e6db74>&#39;United States&#39;</span> 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>WHEN</span> <span style=color:#e6db74>&#39;USA&#39;</span> <span style=color:#66d9ef>THEN</span> <span style=color:#e6db74>&#39;United States&#39;</span> 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>ELSE</span> <span style=color:#e6db74>&#39;n/a&#39;</span> <span style=color:#66d9ef>END</span> <span style=color:#66d9ef>AS</span> country
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> products;
</span></span></code></pre></div><h4 id=data-after-3>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-3>#</a></h4><table><thead><tr><th>marital_status</th><th>gender</th><th>product_line</th><th>country</th></tr></thead><tbody><tr><td>&ldquo;Single&rdquo;</td><td>&ldquo;Female&rdquo;</td><td>&ldquo;Mountain&rdquo;</td><td>&ldquo;Germany&rdquo;</td></tr><tr><td>&ldquo;Married&rdquo;</td><td>&ldquo;Male&rdquo;</td><td>&ldquo;Road&rdquo;</td><td>&ldquo;United States&rdquo;</td></tr><tr><td>&ldquo;n/a&rdquo;</td><td>&ldquo;n/a&rdquo;</td><td>&ldquo;n/a&rdquo;</td><td>&ldquo;United States&rdquo;</td></tr><tr><td>&ldquo;n/a&rdquo;</td><td>&ldquo;n/a&rdquo;</td><td>&ldquo;Touring&rdquo;</td><td>&ldquo;n/a&rdquo;</td></tr></tbody></table><h2 id=5-deriving-values>5. Deriving Values<a hidden class=anchor aria-hidden=true href=#5-deriving-values>#</a></h2><p><strong>Purpose:</strong> Compute missing or dependent values based on existing fields.</p><h3 id=example-4>Example:<a hidden class=anchor aria-hidden=true href=#example-4>#</a></h3><h4 id=data-before-4>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-4>#</a></h4><table><thead><tr><th>order_id</th><th>quantity</th><th>unit_price</th><th>total_price</th></tr></thead><tbody><tr><td>5001</td><td>3</td><td>NULL</td><td>60.00</td></tr><tr><td>5002</td><td>2</td><td>20.00</td><td>NULL</td></tr><tr><td>5003</td><td>4</td><td>NULL</td><td>NULL</td></tr><tr><td>5004</td><td>1</td><td>15.00</td><td>15.00</td></tr></tbody></table><h4 id=sql-transformation-4>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-4>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> order_id, 
</span></span><span style=display:flex><span>       quantity, 
</span></span><span style=display:flex><span>       COALESCE(unit_price, total_price <span style=color:#f92672>/</span> quantity) <span style=color:#66d9ef>AS</span> unit_price, 
</span></span><span style=display:flex><span>       COALESCE(total_price, quantity <span style=color:#f92672>*</span> unit_price) <span style=color:#66d9ef>AS</span> total_price
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> orders;
</span></span></code></pre></div><h4 id=data-after-4>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-4>#</a></h4><table><thead><tr><th>order_id</th><th>quantity</th><th>unit_price</th><th>total_price</th></tr></thead><tbody><tr><td>5001</td><td>3</td><td>20.00</td><td>60.00</td></tr><tr><td>5002</td><td>2</td><td>20.00</td><td>40.00</td></tr><tr><td>5003</td><td>4</td><td>NULL</td><td>NULL</td></tr><tr><td>5004</td><td>1</td><td>15.00</td><td>15.00</td></tr></tbody></table><h2 id=6-conditional-mapping-using-case-when>6. Conditional Mapping Using CASE WHEN<a hidden class=anchor aria-hidden=true href=#6-conditional-mapping-using-case-when>#</a></h2><h3 id=6a-standardizing-categorical-data>6a. Standardizing Categorical Data<a hidden class=anchor aria-hidden=true href=#6a-standardizing-categorical-data>#</a></h3><p><strong>Purpose:</strong> Convert inconsistent category formats to a standard format.</p><h4 id=data-before-5>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-5>#</a></h4><table><thead><tr><th>product_code</th><th>category_code</th></tr></thead><tbody><tr><td>&ldquo;P100&rdquo;</td><td>&ldquo;A-200&rdquo;</td></tr><tr><td>&ldquo;P101&rdquo;</td><td>&ldquo;B-300&rdquo;</td></tr><tr><td>&ldquo;P102&rdquo;</td><td>&ldquo;C400&rdquo;</td></tr></tbody></table><h4 id=sql-transformation-5>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-5>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> product_code, 
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>REPLACE</span>(category_code, <span style=color:#e6db74>&#39;-&#39;</span>, <span style=color:#e6db74>&#39;_&#39;</span>) <span style=color:#66d9ef>AS</span> category_code
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> products;
</span></span></code></pre></div><h4 id=data-after-5>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-5>#</a></h4><table><thead><tr><th>product_code</th><th>category_code</th></tr></thead><tbody><tr><td>&ldquo;P100&rdquo;</td><td>&ldquo;A_200&rdquo;</td></tr><tr><td>&ldquo;P101&rdquo;</td><td>&ldquo;B_300&rdquo;</td></tr><tr><td>&ldquo;P102&rdquo;</td><td>&ldquo;C400&rdquo;</td></tr></tbody></table><h3 id=6b-handling-date-transformations>6b. Handling Date Transformations<a hidden class=anchor aria-hidden=true href=#6b-handling-date-transformations>#</a></h3><p><strong>Purpose:</strong> Format dates from a compact string to a standard date format.</p><h4 id=data-before-6>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-6>#</a></h4><table><thead><tr><th>order_date</th></tr></thead><tbody><tr><td>&ldquo;20240101&rdquo;</td></tr><tr><td>&ldquo;20231231&rdquo;</td></tr><tr><td>&ldquo;20230715&rdquo;</td></tr></tbody></table><h4 id=sql-transformation-6>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-6>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> order_date, 
</span></span><span style=display:flex><span>       TO_DATE(order_date, <span style=color:#e6db74>&#39;YYYYMMDD&#39;</span>) <span style=color:#66d9ef>AS</span> formatted_order_date
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> orders;
</span></span></code></pre></div><h4 id=data-after-6>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-6>#</a></h4><table><thead><tr><th>order_date</th><th>formatted_order_date</th></tr></thead><tbody><tr><td>&ldquo;20240101&rdquo;</td><td>&ldquo;2024-01-01&rdquo;</td></tr><tr><td>&ldquo;20231231&rdquo;</td><td>&ldquo;2023-12-31&rdquo;</td></tr><tr><td>&ldquo;20230715&rdquo;</td><td>&ldquo;2023-07-15&rdquo;</td></tr></tbody></table><h3 id=6c-calculating-order-status>6c. Calculating Order Status<a hidden class=anchor aria-hidden=true href=#6c-calculating-order-status>#</a></h3><p><strong>Purpose:</strong> Derive the shipment status based on shipment and delivery dates.</p><h4 id=data-before-7>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-7>#</a></h4><table><thead><tr><th>shipped_date</th><th>delivered_date</th></tr></thead><tbody><tr><td>NULL</td><td>&ldquo;2024-02-10&rdquo;</td></tr><tr><td>&ldquo;2024-02-05&rdquo;</td><td>&ldquo;2024-02-07&rdquo;</td></tr><tr><td>&ldquo;2024-02-08&rdquo;</td><td>NULL</td></tr><tr><td>&ldquo;2024-02-09&rdquo;</td><td>NULL</td></tr><tr><td>NULL</td><td>NULL</td></tr></tbody></table><h4 id=sql-transformation-7>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-7>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> shipped_date, delivered_date, 
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>CASE</span> 
</span></span><span style=display:flex><span>           <span style=color:#66d9ef>WHEN</span> shipped_date <span style=color:#66d9ef>IS</span> <span style=color:#66d9ef>NULL</span> <span style=color:#66d9ef>THEN</span> <span style=color:#e6db74>&#39;Pending Shipment&#39;</span> 
</span></span><span style=display:flex><span>           <span style=color:#66d9ef>WHEN</span> delivered_date <span style=color:#66d9ef>IS</span> <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span> <span style=color:#66d9ef>THEN</span> <span style=color:#e6db74>&#39;Delivered&#39;</span> 
</span></span><span style=display:flex><span>           <span style=color:#66d9ef>ELSE</span> <span style=color:#e6db74>&#39;In Transit&#39;</span> 
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>END</span> <span style=color:#66d9ef>AS</span> status
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> shipments;
</span></span></code></pre></div><h4 id=data-after-7>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-7>#</a></h4><table><thead><tr><th>shipped_date</th><th>delivered_date</th><th>status</th></tr></thead><tbody><tr><td>NULL</td><td>&ldquo;2024-02-10&rdquo;</td><td>&ldquo;Pending Shipment&rdquo;</td></tr><tr><td>&ldquo;2024-02-05&rdquo;</td><td>&ldquo;2024-02-07&rdquo;</td><td>&ldquo;Delivered&rdquo;</td></tr><tr><td>&ldquo;2024-02-08&rdquo;</td><td>NULL</td><td>&ldquo;In Transit&rdquo;</td></tr><tr><td>&ldquo;2024-02-09&rdquo;</td><td>NULL</td><td>&ldquo;In Transit&rdquo;</td></tr><tr><td>NULL</td><td>NULL</td><td>&ldquo;Pending Shipment&rdquo;</td></tr></tbody></table><h2 id=7-extracting-year-and-month-from-dates>7. Extracting Year and Month from Dates<a hidden class=anchor aria-hidden=true href=#7-extracting-year-and-month-from-dates>#</a></h2><p><strong>Purpose:</strong> Isolate year and month components from a date for time-series analysis.</p><h4 id=data-before-8>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-8>#</a></h4><table><thead><tr><th>order_date</th></tr></thead><tbody><tr><td>&ldquo;2024-05-15&rdquo;</td></tr><tr><td>&ldquo;2023-11-30&rdquo;</td></tr><tr><td>&ldquo;2024-01-01&rdquo;</td></tr><tr><td>&ldquo;2024-12-25&rdquo;</td></tr></tbody></table><h4 id=sql-transformation-8>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-8>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> order_date, 
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>EXTRACT</span>(<span style=color:#66d9ef>YEAR</span> <span style=color:#66d9ef>FROM</span> order_date) <span style=color:#66d9ef>AS</span> order_year, 
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>EXTRACT</span>(<span style=color:#66d9ef>MONTH</span> <span style=color:#66d9ef>FROM</span> order_date) <span style=color:#66d9ef>AS</span> order_month
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> orders;
</span></span></code></pre></div><h4 id=data-after-8>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-8>#</a></h4><table><thead><tr><th>order_date</th><th>order_year</th><th>order_month</th></tr></thead><tbody><tr><td>&ldquo;2024-05-15&rdquo;</td><td>2024</td><td>5</td></tr><tr><td>&ldquo;2023-11-30&rdquo;</td><td>2023</td><td>11</td></tr><tr><td>&ldquo;2024-01-01&rdquo;</td><td>2024</td><td>1</td></tr><tr><td>&ldquo;2024-12-25&rdquo;</td><td>2024</td><td>12</td></tr></tbody></table><h2 id=8-aggregating-data>8. Aggregating Data<a hidden class=anchor aria-hidden=true href=#8-aggregating-data>#</a></h2><p><strong>Purpose:</strong> Summarize data by grouping and applying aggregate functions like SUM, AVG, COUNT, etc.</p><h4 id=data-before-9>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-9>#</a></h4><table><thead><tr><th>product_id</th><th>quantity</th></tr></thead><tbody><tr><td>101</td><td>5</td></tr><tr><td>102</td><td>3</td></tr><tr><td>101</td><td>2</td></tr><tr><td>103</td><td>4</td></tr></tbody></table><h4 id=sql-transformation-9>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-9>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> product_id, 
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>SUM</span>(quantity) <span style=color:#66d9ef>AS</span> total_quantity
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> orders
</span></span><span style=display:flex><span><span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> product_id;
</span></span></code></pre></div><h4 id=data-after-9>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-9>#</a></h4><table><thead><tr><th>product_id</th><th>total_quantity</th></tr></thead><tbody><tr><td>101</td><td>7</td></tr><tr><td>102</td><td>3</td></tr><tr><td>103</td><td>4</td></tr></tbody></table><h2 id=9-pivoting-data>9. Pivoting Data<a hidden class=anchor aria-hidden=true href=#9-pivoting-data>#</a></h2><p><strong>Purpose:</strong> Transform rows into columns to create a pivot table.</p><h4 id=data-before-10>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-10>#</a></h4><table><thead><tr><th>product_id</th><th>month</th><th>sales</th></tr></thead><tbody><tr><td>101</td><td>Jan</td><td>100</td></tr><tr><td>101</td><td>Feb</td><td>150</td></tr><tr><td>102</td><td>Jan</td><td>200</td></tr><tr><td>102</td><td>Feb</td><td>250</td></tr></tbody></table><h4 id=sql-transformation-10>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-10>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> product_id,
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>SUM</span>(<span style=color:#66d9ef>CASE</span> <span style=color:#66d9ef>WHEN</span> <span style=color:#66d9ef>month</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Jan&#39;</span> <span style=color:#66d9ef>THEN</span> sales <span style=color:#66d9ef>ELSE</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>END</span>) <span style=color:#66d9ef>AS</span> Jan_sales,
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>SUM</span>(<span style=color:#66d9ef>CASE</span> <span style=color:#66d9ef>WHEN</span> <span style=color:#66d9ef>month</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Feb&#39;</span> <span style=color:#66d9ef>THEN</span> sales <span style=color:#66d9ef>ELSE</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>END</span>) <span style=color:#66d9ef>AS</span> Feb_sales
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> sales
</span></span><span style=display:flex><span><span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> product_id;
</span></span></code></pre></div><h4 id=data-after-10>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-10>#</a></h4><table><thead><tr><th>product_id</th><th>Jan_sales</th><th>Feb_sales</th></tr></thead><tbody><tr><td>101</td><td>100</td><td>150</td></tr><tr><td>102</td><td>200</td><td>250</td></tr></tbody></table><h2 id=10-unpivoting-data>10. Unpivoting Data<a hidden class=anchor aria-hidden=true href=#10-unpivoting-data>#</a></h2><p><strong>Purpose:</strong> Transform columns into rows to normalize a pivot table.</p><h4 id=data-before-11>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-11>#</a></h4><table><thead><tr><th>product_id</th><th>Jan_sales</th><th>Feb_sales</th></tr></thead><tbody><tr><td>101</td><td>100</td><td>150</td></tr><tr><td>102</td><td>200</td><td>250</td></tr></tbody></table><h4 id=sql-transformation-11>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-11>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> product_id, 
</span></span><span style=display:flex><span>       <span style=color:#e6db74>&#39;Jan&#39;</span> <span style=color:#66d9ef>AS</span> <span style=color:#66d9ef>month</span>, Jan_sales <span style=color:#66d9ef>AS</span> sales
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> sales
</span></span><span style=display:flex><span><span style=color:#66d9ef>UNION</span> <span style=color:#66d9ef>ALL</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> product_id, 
</span></span><span style=display:flex><span>       <span style=color:#e6db74>&#39;Feb&#39;</span> <span style=color:#66d9ef>AS</span> <span style=color:#66d9ef>month</span>, Feb_sales <span style=color:#66d9ef>AS</span> sales
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> sales;
</span></span></code></pre></div><h4 id=data-after-11>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-11>#</a></h4><table><thead><tr><th>product_id</th><th>month</th><th>sales</th></tr></thead><tbody><tr><td>101</td><td>Jan</td><td>100</td></tr><tr><td>101</td><td>Feb</td><td>150</td></tr><tr><td>102</td><td>Jan</td><td>200</td></tr><tr><td>102</td><td>Feb</td><td>250</td></tr></tbody></table><h2 id=11-joining-tables>11. Joining Tables<a hidden class=anchor aria-hidden=true href=#11-joining-tables>#</a></h2><p><strong>Purpose:</strong> Combine data from multiple tables based on a related column.</p><h4 id=data-before-12>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-12>#</a></h4><p><strong>Orders Table:</strong></p><table><thead><tr><th>order_id</th><th>customer_id</th></tr></thead><tbody><tr><td>1</td><td>101</td></tr><tr><td>2</td><td>102</td></tr></tbody></table><p><strong>Customers Table:</strong></p><table><thead><tr><th>customer_id</th><th>customer_name</th></tr></thead><tbody><tr><td>101</td><td>John Doe</td></tr><tr><td>102</td><td>Alice Brown</td></tr></tbody></table><h4 id=sql-transformation-12>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-12>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> orders.order_id, 
</span></span><span style=display:flex><span>       customers.customer_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> orders
</span></span><span style=display:flex><span><span style=color:#66d9ef>JOIN</span> customers <span style=color:#66d9ef>ON</span> orders.customer_id <span style=color:#f92672>=</span> customers.customer_id;
</span></span></code></pre></div><h4 id=data-after-12>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-12>#</a></h4><table><thead><tr><th>order_id</th><th>customer_name</th></tr></thead><tbody><tr><td>1</td><td>John Doe</td></tr><tr><td>2</td><td>Alice Brown</td></tr></tbody></table><h2 id=12-filtering-data>12. Filtering Data<a hidden class=anchor aria-hidden=true href=#12-filtering-data>#</a></h2><p><strong>Purpose:</strong> Extract specific rows based on a condition.</p><h4 id=data-before-13>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-13>#</a></h4><table><thead><tr><th>order_id</th><th>order_date</th><th>total_amount</th></tr></thead><tbody><tr><td>1</td><td>2024-01-15</td><td>100.00</td></tr><tr><td>2</td><td>2024-02-20</td><td>200.00</td></tr><tr><td>3</td><td>2024-03-10</td><td>150.00</td></tr></tbody></table><h4 id=sql-transformation-13>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-13>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> order_id, order_date, total_amount
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> orders
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> total_amount <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>150</span>.<span style=color:#ae81ff>00</span>;
</span></span></code></pre></div><h4 id=data-after-13>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-13>#</a></h4><table><thead><tr><th>order_id</th><th>order_date</th><th>total_amount</th></tr></thead><tbody><tr><td>2</td><td>2024-02-20</td><td>200.00</td></tr></tbody></table><h2 id=13-calculating-running-totals>13. Calculating Running Totals<a hidden class=anchor aria-hidden=true href=#13-calculating-running-totals>#</a></h2><p><strong>Purpose:</strong> Compute cumulative totals over a specified order.</p><h4 id=data-before-14>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-14>#</a></h4><table><thead><tr><th>order_id</th><th>order_date</th><th>total_amount</th></tr></thead><tbody><tr><td>1</td><td>2024-01-15</td><td>100.00</td></tr><tr><td>2</td><td>2024-02-20</td><td>200.00</td></tr><tr><td>3</td><td>2024-03-10</td><td>150.00</td></tr></tbody></table><h4 id=sql-transformation-14>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-14>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> order_id, order_date, total_amount,
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>SUM</span>(total_amount) OVER (<span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> order_date) <span style=color:#66d9ef>AS</span> running_total
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> orders;
</span></span></code></pre></div><h4 id=data-after-14>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-14>#</a></h4><table><thead><tr><th>order_id</th><th>order_date</th><th>total_amount</th><th>running_total</th></tr></thead><tbody><tr><td>1</td><td>2024-01-15</td><td>100.00</td><td>100.00</td></tr><tr><td>2</td><td>2024-02-20</td><td>200.00</td><td>300.00</td></tr><tr><td>3</td><td>2024-03-10</td><td>150.00</td><td>450.00</td></tr></tbody></table><h2 id=14-calculating-moving-averages>14. Calculating Moving Averages<a hidden class=anchor aria-hidden=true href=#14-calculating-moving-averages>#</a></h2><p><strong>Purpose:</strong> Compute the average of a specified number of preceding rows.</p><h4 id=data-before-15>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-15>#</a></h4><table><thead><tr><th>order_id</th><th>order_date</th><th>total_amount</th></tr></thead><tbody><tr><td>1</td><td>2024-01-15</td><td>100.00</td></tr><tr><td>2</td><td>2024-02-20</td><td>200.00</td></tr><tr><td>3</td><td>2024-03-10</td><td>150.00</td></tr><tr><td>4</td><td>2024-04-05</td><td>300.00</td></tr></tbody></table><h4 id=sql-transformation-15>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-15>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> order_id, order_date, total_amount,
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>AVG</span>(total_amount) OVER (<span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> order_date <span style=color:#66d9ef>ROWS</span> <span style=color:#66d9ef>BETWEEN</span> <span style=color:#ae81ff>1</span> PRECEDING <span style=color:#66d9ef>AND</span> <span style=color:#66d9ef>CURRENT</span> <span style=color:#66d9ef>ROW</span>) <span style=color:#66d9ef>AS</span> moving_avg
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> orders;
</span></span></code></pre></div><h4 id=data-after-15>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-15>#</a></h4><table><thead><tr><th>order_id</th><th>order_date</th><th>total_amount</th><th>moving_avg</th></tr></thead><tbody><tr><td>1</td><td>2024-01-15</td><td>100.00</td><td>100.00</td></tr><tr><td>2</td><td>2024-02-20</td><td>200.00</td><td>150.00</td></tr><tr><td>3</td><td>2024-03-10</td><td>150.00</td><td>175.00</td></tr><tr><td>4</td><td>2024-04-05</td><td>300.00</td><td>225.00</td></tr></tbody></table><h2 id=15-data-type-conversion>15. Data Type Conversion<a hidden class=anchor aria-hidden=true href=#15-data-type-conversion>#</a></h2><p><strong>Purpose:</strong> Convert data from one type to another for consistency and compatibility.</p><h4 id=data-before-16>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-16>#</a></h4><table><thead><tr><th>order_id</th><th>order_date</th><th>total_amount</th></tr></thead><tbody><tr><td>1</td><td>&ldquo;2024-01-15&rdquo;</td><td>&ldquo;100.00&rdquo;</td></tr><tr><td>2</td><td>&ldquo;2024-02-20&rdquo;</td><td>&ldquo;200.00&rdquo;</td></tr></tbody></table><h4 id=sql-transformation-16>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-16>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> order_id, 
</span></span><span style=display:flex><span>       TO_DATE(order_date, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span>) <span style=color:#66d9ef>AS</span> order_date, 
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>CAST</span>(total_amount <span style=color:#66d9ef>AS</span> DECIMAL(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>2</span>)) <span style=color:#66d9ef>AS</span> total_amount
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> orders;
</span></span></code></pre></div><h4 id=data-after-16>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-16>#</a></h4><table><thead><tr><th>order_id</th><th>order_date</th><th>total_amount</th></tr></thead><tbody><tr><td>1</td><td>2024-01-15</td><td>100.00</td></tr><tr><td>2</td><td>2024-02-20</td><td>200.00</td></tr></tbody></table><h2 id=16-removing-duplicates>16. Removing Duplicates<a hidden class=anchor aria-hidden=true href=#16-removing-duplicates>#</a></h2><p><strong>Purpose:</strong> Eliminate duplicate rows from a dataset to ensure data integrity.</p><h4 id=data-before-17>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-17>#</a></h4><table><thead><tr><th>customer_id</th><th>email</th></tr></thead><tbody><tr><td>101</td><td>&ldquo;<a href=mailto:john@abc.com>john@abc.com</a>&rdquo;</td></tr><tr><td>102</td><td>&ldquo;<a href=mailto:alice@xyz.com>alice@xyz.com</a>&rdquo;</td></tr><tr><td>101</td><td>&ldquo;<a href=mailto:john@abc.com>john@abc.com</a>&rdquo;</td></tr></tbody></table><h4 id=sql-transformation-17>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-17>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>DISTINCT</span> customer_id, email
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> customers;
</span></span></code></pre></div><h4 id=data-after-17>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-17>#</a></h4><table><thead><tr><th>customer_id</th><th>email</th></tr></thead><tbody><tr><td>101</td><td>&ldquo;<a href=mailto:john@abc.com>john@abc.com</a>&rdquo;</td></tr><tr><td>102</td><td>&ldquo;<a href=mailto:alice@xyz.com>alice@xyz.com</a>&rdquo;</td></tr></tbody></table><h2 id=17-calculating-percentages>17. Calculating Percentages<a hidden class=anchor aria-hidden=true href=#17-calculating-percentages>#</a></h2><p><strong>Purpose:</strong> Compute the percentage of a value relative to a total.</p><h4 id=data-before-18>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-18>#</a></h4><table><thead><tr><th>product_id</th><th>sales</th></tr></thead><tbody><tr><td>101</td><td>100</td></tr><tr><td>102</td><td>200</td></tr><tr><td>103</td><td>300</td></tr></tbody></table><h4 id=sql-transformation-18>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-18>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> product_id, 
</span></span><span style=display:flex><span>       sales, 
</span></span><span style=display:flex><span>       (sales <span style=color:#f92672>/</span> <span style=color:#66d9ef>SUM</span>(sales) OVER ()) <span style=color:#f92672>*</span> <span style=color:#ae81ff>100</span> <span style=color:#66d9ef>AS</span> sales_percentage
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> products;
</span></span></code></pre></div><h4 id=data-after-18>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-18>#</a></h4><table><thead><tr><th>product_id</th><th>sales</th><th>sales_percentage</th></tr></thead><tbody><tr><td>101</td><td>100</td><td>16.67</td></tr><tr><td>102</td><td>200</td><td>33.33</td></tr><tr><td>103</td><td>300</td><td>50.00</td></tr></tbody></table><h2 id=18-string-concatenation>18. String Concatenation<a hidden class=anchor aria-hidden=true href=#18-string-concatenation>#</a></h2><p><strong>Purpose:</strong> Combine multiple string fields into a single field.</p><h4 id=data-before-19>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-19>#</a></h4><table><thead><tr><th>first_name</th><th>last_name</th></tr></thead><tbody><tr><td>John</td><td>Doe</td></tr><tr><td>Alice</td><td>Brown</td></tr></tbody></table><h4 id=sql-transformation-19>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-19>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> first_name, 
</span></span><span style=display:flex><span>       last_name, 
</span></span><span style=display:flex><span>       CONCAT(first_name, <span style=color:#e6db74>&#39; &#39;</span>, last_name) <span style=color:#66d9ef>AS</span> full_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> customers;
</span></span></code></pre></div><h4 id=data-after-19>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-19>#</a></h4><table><thead><tr><th>first_name</th><th>last_name</th><th>full_name</th></tr></thead><tbody><tr><td>John</td><td>Doe</td><td>John Doe</td></tr><tr><td>Alice</td><td>Brown</td><td>Alice Brown</td></tr></tbody></table><h2 id=19-conditional-aggregation>19. Conditional Aggregation<a hidden class=anchor aria-hidden=true href=#19-conditional-aggregation>#</a></h2><p><strong>Purpose:</strong> Aggregate data based on a condition.</p><h4 id=data-before-20>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-20>#</a></h4><table><thead><tr><th>product_id</th><th>sales</th><th>region</th></tr></thead><tbody><tr><td>101</td><td>100</td><td>North</td></tr><tr><td>102</td><td>200</td><td>South</td></tr><tr><td>101</td><td>150</td><td>North</td></tr><tr><td>102</td><td>250</td><td>South</td></tr></tbody></table><h4 id=sql-transformation-20>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-20>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> product_id, 
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>SUM</span>(<span style=color:#66d9ef>CASE</span> <span style=color:#66d9ef>WHEN</span> region <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;North&#39;</span> <span style=color:#66d9ef>THEN</span> sales <span style=color:#66d9ef>ELSE</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>END</span>) <span style=color:#66d9ef>AS</span> north_sales,
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>SUM</span>(<span style=color:#66d9ef>CASE</span> <span style=color:#66d9ef>WHEN</span> region <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;South&#39;</span> <span style=color:#66d9ef>THEN</span> sales <span style=color:#66d9ef>ELSE</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>END</span>) <span style=color:#66d9ef>AS</span> south_sales
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> sales
</span></span><span style=display:flex><span><span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> product_id;
</span></span></code></pre></div><h4 id=data-after-20>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-20>#</a></h4><table><thead><tr><th>product_id</th><th>north_sales</th><th>south_sales</th></tr></thead><tbody><tr><td>101</td><td>250</td><td>0</td></tr><tr><td>102</td><td>0</td><td>450</td></tr></tbody></table><h2 id=20-data-masking>20. Data Masking<a hidden class=anchor aria-hidden=true href=#20-data-masking>#</a></h2><p><strong>Purpose:</strong> Protect sensitive data by masking it.</p><h4 id=data-before-21>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-21>#</a></h4><table><thead><tr><th>customer_id</th><th>email</th></tr></thead><tbody><tr><td>101</td><td>&ldquo;<a href=mailto:john@abc.com>john@abc.com</a>&rdquo;</td></tr><tr><td>102</td><td>&ldquo;<a href=mailto:alice@xyz.com>alice@xyz.com</a>&rdquo;</td></tr></tbody></table><h4 id=sql-transformation-21>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-21>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> customer_id, 
</span></span><span style=display:flex><span>       CONCAT(<span style=color:#66d9ef>SUBSTRING</span>(email, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>), <span style=color:#e6db74>&#39;*****&#39;</span>, <span style=color:#66d9ef>SUBSTRING</span>(email, CHARINDEX(<span style=color:#e6db74>&#39;@&#39;</span>, email), LEN(email))) <span style=color:#66d9ef>AS</span> masked_email
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> customers;
</span></span></code></pre></div><h4 id=data-after-21>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-21>#</a></h4><table><thead><tr><th>customer_id</th><th>masked_email</th></tr></thead><tbody><tr><td>101</td><td>&ldquo;<a href=mailto:jo*****@abc.com>jo*****@abc.com</a>&rdquo;</td></tr><tr><td>102</td><td>&ldquo;<a href=mailto:al*****@xyz.com>al*****@xyz.com</a>&rdquo;</td></tr></tbody></table><h2 id=21-calculating-differences>21. Calculating Differences<a hidden class=anchor aria-hidden=true href=#21-calculating-differences>#</a></h2><p><strong>Purpose:</strong> Compute the difference between values in consecutive rows.</p><h4 id=data-before-22>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-22>#</a></h4><table><thead><tr><th>order_id</th><th>order_date</th><th>total_amount</th></tr></thead><tbody><tr><td>1</td><td>2024-01-15</td><td>100.00</td></tr><tr><td>2</td><td>2024-02-20</td><td>200.00</td></tr><tr><td>3</td><td>2024-03-10</td><td>150.00</td></tr></tbody></table><h4 id=sql-transformation-22>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-22>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> order_id, 
</span></span><span style=display:flex><span>       order_date, 
</span></span><span style=display:flex><span>       total_amount, 
</span></span><span style=display:flex><span>       total_amount <span style=color:#f92672>-</span> LAG(total_amount) OVER (<span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> order_date) <span style=color:#66d9ef>AS</span> amount_difference
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> orders;
</span></span></code></pre></div><h4 id=data-after-22>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-22>#</a></h4><table><thead><tr><th>order_id</th><th>order_date</th><th>total_amount</th><th>amount_difference</th></tr></thead><tbody><tr><td>1</td><td>2024-01-15</td><td>100.00</td><td>NULL</td></tr><tr><td>2</td><td>2024-02-20</td><td>200.00</td><td>100.00</td></tr><tr><td>3</td><td>2024-03-10</td><td>150.00</td><td>-50.00</td></tr></tbody></table><h2 id=22-data-binning>22. Data Binning<a hidden class=anchor aria-hidden=true href=#22-data-binning>#</a></h2><p><strong>Purpose:</strong> Group continuous data into bins or intervals.</p><h4 id=data-before-23>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-23>#</a></h4><table><thead><tr><th>order_id</th><th>total_amount</th></tr></thead><tbody><tr><td>1</td><td>100.00</td></tr><tr><td>2</td><td>200.00</td></tr><tr><td>3</td><td>150.00</td></tr><tr><td>4</td><td>300.00</td></tr></tbody></table><h4 id=sql-transformation-23>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-23>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> order_id, 
</span></span><span style=display:flex><span>       total_amount, 
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>CASE</span> 
</span></span><span style=display:flex><span>           <span style=color:#66d9ef>WHEN</span> total_amount <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>150</span> <span style=color:#66d9ef>THEN</span> <span style=color:#e6db74>&#39;Low&#39;</span> 
</span></span><span style=display:flex><span>           <span style=color:#66d9ef>WHEN</span> total_amount <span style=color:#66d9ef>BETWEEN</span> <span style=color:#ae81ff>150</span> <span style=color:#66d9ef>AND</span> <span style=color:#ae81ff>250</span> <span style=color:#66d9ef>THEN</span> <span style=color:#e6db74>&#39;Medium&#39;</span> 
</span></span><span style=display:flex><span>           <span style=color:#66d9ef>ELSE</span> <span style=color:#e6db74>&#39;High&#39;</span> 
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>END</span> <span style=color:#66d9ef>AS</span> amount_bin
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> orders;
</span></span></code></pre></div><h4 id=data-after-23>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-23>#</a></h4><table><thead><tr><th>order_id</th><th>total_amount</th><th>amount_bin</th></tr></thead><tbody><tr><td>1</td><td>100.00</td><td>Low</td></tr><tr><td>2</td><td>200.00</td><td>Medium</td></tr><tr><td>3</td><td>150.00</td><td>Medium</td></tr><tr><td>4</td><td>300.00</td><td>High</td></tr></tbody></table><h2 id=23-handling-outliers>23. Handling Outliers<a hidden class=anchor aria-hidden=true href=#23-handling-outliers>#</a></h2><p><strong>Purpose:</strong> Identify and handle outliers in the data.</p><h4 id=data-before-24>Data Before:<a hidden class=anchor aria-hidden=true href=#data-before-24>#</a></h4><table><thead><tr><th>order_id</th><th>total_amount</th></tr></thead><tbody><tr><td>1</td><td>100.00</td></tr><tr><td>2</td><td>200.00</td></tr><tr><td>3</td><td>150.00</td></tr><tr><td>4</td><td>1000.00</td></tr></tbody></table><h4 id=sql-transformation-24>SQL Transformation:<a hidden class=anchor aria-hidden=true href=#sql-transformation-24>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> order_id, 
</span></span><span style=display:flex><span>       total_amount, 
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>CASE</span> 
</span></span><span style=display:flex><span>           <span style=color:#66d9ef>WHEN</span> total_amount <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>*</span> (<span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>AVG</span>(total_amount) <span style=color:#66d9ef>FROM</span> orders) <span style=color:#66d9ef>THEN</span> <span style=color:#e6db74>&#39;Outlier&#39;</span> 
</span></span><span style=display:flex><span>           <span style=color:#66d9ef>ELSE</span> <span style=color:#e6db74>&#39;Normal&#39;</span> 
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>END</span> <span style=color:#66d9ef>AS</span> amount_status
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> orders;
</span></span></code></pre></div><h4 id=data-after-24>Data After:<a hidden class=anchor aria-hidden=true href=#data-after-24>#</a></h4><table><thead><tr><th>order_id</th><th>total_amount</th><th>amount_status</th></tr></thead><tbody><tr><td>1</td><td>100.00</td><td>Normal</td></tr><tr><td>2</td><td>200.00</td><td>Normal</td></tr><tr><td>3</td><td>150.00</td><td>Normal</td></tr><tr><td>4</td><td>1000.00</td><td>Outlier</td></tr></tbody></table><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>By applying these transformation techniques, ETL pipelines can ensure that raw data is clean, consistent, and ready for analytics. Whether dealing with text normalization, handling missing values, deduplication, or deriving computed fields, these methods help maintain high-quality datasets essential for business insights.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://priya.se/tags/etl/>ETL</a></li><li><a href=https://priya.se/tags/data-engineering/>Data Engineering</a></li><li><a href=https://priya.se/tags/data-cleaning/>Data Cleaning</a></li><li><a href=https://priya.se/tags/normalization/>Normalization</a></li><li><a href=https://priya.se/tags/sql/>SQL</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://priya.se/>Priyanka Yelluru</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>